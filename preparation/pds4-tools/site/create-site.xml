<project name="Object Access Library Site Creator" default="site">

	<property name="project.build.directory" location="target" />
	<property name="stage" location="${project.build.directory}/stage" />
	
	<macrodef name="copy-site">
		<attribute name="module-name" />
		<attribute name="module-dir" />
		<sequential>
			<mkdir dir="${stage}/@{module-name}" />
			<copy todir="${stage}/@{module-name}">
				<fileset dir="@{module-dir}/target/site" />
			</copy>
		</sequential>
	</macrodef>
	
	<target name="site" description="Create the consolidated site directory">
		<delete dir="${stage}" quiet="true" />
		
		<!--copy-site module-name="dependencies" module-dir="../dependencies" /-->
		<copy-site module-name="objectAccess" module-dir="../objectAccess" />
		<copy-site module-name="dataModel" module-dir="../dataModel" />
		<copy-site module-name="site" module-dir="../site" />				
		<copy-site module-name="." module-dir="../superpom" />
		
		<!-- Now create a dummy index.html inside the superpom/ directory that
		     redirects to the root. -->
		<mkdir dir="${stage}/superpom" />
		<echoxml file="${stage}/superpom/index.html">
			<html>
				<head>
					<title>Superpom Placeholder</title>
					<meta http-equiv="refresh" content="0; url=../index.html" />
				</head>
				<body>
					<h1>Superpom Placeholder</h1>
					<p>You should be redirected to the Superpom project shortly.
					Or you can <a href="../index.html">go there now.</a></p>
				</body>
			</html>
		</echoxml>
	</target>
		
</project>