function returnObject(objectReference){var type=typeof(objectReference);switch(type){case"string":var foundObject=document.getElementById(objectReference);if(foundObject!==null){if(foundObject.id!=objectReference){throw"Collision between element name and id.";}return foundObject;}return null;case"object":return objectReference;default:return null;}}function setInnerHTML(object,value){try{object.innerHTML=value;}catch(e){try{var textNode=document.createTextNode(value);object.appendChild(textNode);}catch(e){alert(e.message+" "+typeof(object.innerHTML)+" "+value);}}}function asynchronousRequest(){var _instanceReference=this;var _handler=function(){};var _URL=null;var _transferMethod="POST";var _isAsynch=true;var _paramString="";var _timeoutSeconds=20;var _request=null;var _loaded=false;var _timeoutID;this.setTransferMethod=function(transferMethod){if(transferMethod=="GET"||transferMethod=="POST"){_transferMethod=transferMethod;}else{throw new Error(1,"invalid transferMethod type");}};this.setIsAsynch=function(isAsynch){if(isAsynch==true||isAsynch==false){_isAsynch=isAsynch;
}};this.setParamString=function(paramString){_paramString=paramString;};this.setURL=function(URL){_URL=URL;};this.setHandlerFunction=function(handler){_handler=handler;};this.setTimeoutSeconds=function(numSeconds){_timeoutSeconds=numSeconds;};this.getTimeout=function(){return _timeoutSeconds*1000;};this.checkTimeout=function(){if(!_loaded){_request.abort();}else{alert("loaded in time");}};function handleRequest(){if(_request.readyState==4){if(_request.status==200){var requestData=_request.responseText;try{eval("var requestObject = ("+requestData+")");}catch(e){var requestObject=requestData;}_handler(requestObject);}else{var requestObject={"error":{"errorCode":_request.status,"errorText":_request.statusText}};_handler(requestObject);}_loaded=true;clearTimeout(_timeoutID);try{_request.onreadystatechange=null;}catch(e){_request.onreadystatechange=function(){};}}}this.run=function(){
if(!_request&&typeof XMLHttpRequest!="undefined"){_request=new XMLHttpRequest();
}_request.onreadystatechange=handleRequest;_request.open(_transferMethod,_URL,_isAsynch);_request.setRequestHeader("Content-type","application/x-www-form-urlencoded");_request.setRequestHeader("Content-length",_paramString.length);_request.setRequestHeader("Connection","close");_request.send(_paramString);};}function redirect(location){window.location=location;}function openNew(location){window.open(location,"new");}var cookieManager={set:function(name,value,expiration,path,domain,secure){if(!expiration){expiration=365;}var date=new Date();date.setTime(date.getTime()+(expiration*24*60*60*1000));if(!path){path="/";}var cookieString=name+"="+escape(value)+";expires="+date.toGMTString()+((path)?";path="+path:"")+((domain)?";domain="+domain:"")+((secure)?";secure":"");document.cookie=cookieString;},get:function(name){var namePattern=name+"=";var cookies=document.cookie.split(";");for(var i=0,n=cookies.length;i<n;i++){var c=cookies[i];while(c.charAt(0)==" "){c=c.substring(1,c.length);}if(c.indexOf(namePattern)==0){return c.substring(namePattern.length,c.length);
}}return null;},remove:function(name){cookieManager.set(name,"",-1);},getPageID:function(){var sectionString=document.location.pathname;sectionString=sectionString.replace(/\//gi,"");var searchString=document.location.search;searchString=searchString.replace(/^.*action=([^&]*).*/gi,"$1");if(searchString==""){searchString="index";}var cookieBase=sectionString+"_"+searchString+"_";return cookieBase;}};function contains(a,obj){var i=a.length;while(i--){if(a[i]===obj){return true;}}return false;}
