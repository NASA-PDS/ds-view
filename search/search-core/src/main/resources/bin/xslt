#! /bin/bash

echo
echo "Running XSLT transformation..."
echo

if [ "$1" != "" ]; then
    SEARCH_HOME=${1}
else
    echo
    echo "SEARCH_HOME must be specified via command-line:  ./xslt <search-home>"
    echo
    exit 0
fi

SEARCH_HOME=$1
echo $SEARCH_HOME
export SAXON_LIB=$SEARCH_HOME/../lib
CLASSPATH=`echo $SAXON_LIB/*.jar | sed -e 's/ /:/g'`

if [ $# -lt 2 ]; then
  echo "usage: $0 xmlFile stylesheet [outFile]"
  exit 1
fi

shift
IN="-s:$1"
STYLESHEET="-xsl:$2"
shift 2

if [ $# -lt 1 ]; then
  java -jar $SAXON_LIB/saxon-9.jar "$IN" "$STYLESHEET"
else
  OUT="-o:$1"
  shift
  echo "java -Xmx256m -jar $SAXON_LIB/saxon-9.jar \"$IN\" \"$STYLESHEET\" \"$OUT\" \"$@\""
  java -Xmx256m -jar $SAXON_LIB/saxon-9.jar "$IN" "$STYLESHEET" "$OUT" "$@"
fi
