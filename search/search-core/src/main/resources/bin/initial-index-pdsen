#!/bin/bash

####################################################################
#
# initial-index-en
#
# Script used to generate an index using the search-core, and call
# solr-post to post the data to the search-service.
#
# This script is specific to PDS Engineering
#
# $Id$
#
####################################################################

DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"

PDS3_FLAG=1
PSA_FLAG=0
PDS4_FLAG=0

debug=$1
arguments=

# Check if search-core is in PATH
hash search-core 2>/dev/null || { echo >&2 "search-core must be installed in PATH.  Aborting."; exit 1; }

echo
echo
echo "-----Running search-core------"
if [ "${debug}" == "debug" ]; then
    arguments="-d -m 5"
fi

arguments="${arguments} -p"
if [ "${PDS3_FLAG}" == "1" ]; then
    echo " With PDS3 Products "
    arguments="${arguments} ${DIR}/../conf/pds/pds3/core.properties"
fi

if [ "${PSA_FLAG}" == "1" ]; then
    echo " With PSA Products"
    arguments="${arguments} ${DIR}/../conf/psa/pds3/core.properties"
fi

if [ "${PDS4_FLAG}" == "1" ]; then
    echo "  With PDS4 Products"
    arguments="${arguments} ${DIR}/../conf/pds/pds4/core.properties"
fi

search-core $arguments

echo "-----search-core Complete-----"
echo
echo

solr-post
