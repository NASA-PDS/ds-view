<?xml version="1.0" encoding="UTF-8"?>

<!--
  Copyright 2016, by the California Institute of Technology.
  ALL RIGHTS RESERVED. United States Government Sponsorship acknowledged.
  Any commercial use must be negotiated with the Office of Technology
  Transfer at the California Institute of Technology.

  This software is subject to U. S. export control laws and regulations
  (22 C.F.R. 120-130 and 15 C.F.R. 730-774). To the extent that the software
  is subject to U.S. export control laws and regulations, the recipient has
  the responsibility to obtain export licenses or other export authority as
  may be required before exporting such information to foreign countries or
  providing access to foreign nationals.

  $Id$
-->

<document>
  <properties>
    <title>Release Description 7.0.0</title>
    <author email="Sean.Hardman@jpl.nasa.gov">Sean Hardman</author>
  </properties>

  <body>
    <section name="Release Description 7.0.0">
      <p>This release of the PDS4 System represents Build 7a and is intended as an operational release of the system components to date. The following sections can be found in this document:
      </p>

      <ul>
        <li><a href="#Reference_Documents">Reference Documents</a></li>
        <li><a href="#Capabilities">Capabilities</a></li>
        <li><a href="#Liens">Liens</a></li>
        <li><a href="#System_Requirements">System Requirements</a></li>
        <li><a href="#InstallationOperation">Installation/Operation</a></li>
      </ul>
    </section>

    <section name="Reference Documents">
      <p>This section details the controlling and applicable documents referenced for this release. The controlling documents are as follows:
      </p>

      <ul>
        <li>PDS Level 1, 2 and 3 Requirements, April 10, 2014.</li>
        <li>PDS4 Project Plan, July 17, 2013.</li>
        <li>PDS4 System Architecture Specification, Version 1.3, September 1, 2013.</li>
        <li>PDS4 Operations Concept, Version 1.0, September 1, 2013.</li>
        <li>PDS General System Software Requirements Document (SRD), Version 1.1, September 1, 2013.</li>
        <li>PDS Harvest Tool Software Requirements and Design Document (SRD/SDD), Version 1.2, September 1, 2013.</li>
        <li>PDS Preparation Tools Software Requirements and Design Document (SRD/SDD), Version 0.3, September 1, 2013.</li>
        <li>PDS Registry Service Software Requirements and Design Document (SRD/SDD), Version 1.1, September 1, 2013.</li>
        <li>PDS Report Service Software Requirements and Design Document (SRD/SDD), Version 1.1, September 1, 2013.</li>
        <li>PDS Search Service Software Requirements and Design Document (SRD/SDD), Version 1.0, September 1, 2013.</li>
        <ul>
          <li>PDS Search Scenarios, Version 1.0, September 1, 2013.</li>
          <li>PDS Search Protocol, Version 1.2, March 21, 2014.</li>
          <li>PDAP Search Protocol, Version 1.0, March 21, 2014.</li>
        </ul>
        <li>PDS Security Service Software Requirements and Design Document (SRD/SDD), Version 1.1, September 1, 2013.</li>
      </ul>
    </section>

    <section name="Capabilities">
      <p>This section details the new, modified and corrected capabilities that comprise this release. They are summarized here for a system-level view. A more detailed list of capabilities can be found in the change logs for each component.
      </p>

      <subsection name="New Capabilities">
        <p>The following are new capabilities for this release:
        </p>

        <ul>
          <li>[<a href='https://oodt.jpl.nasa.gov/jira/browse/PDS-288'>PDS-288</a>] - Harvest: Add support for registering unlabeled files in a PDS3 harvest run
          </li>
          <li>[<a href='https://oodt.jpl.nasa.gov/jira/browse/PDS-430'>PDS-430</a>] - Tool Registry: Develop interface for submitting and browsing tools and services
          </li>
          <li>[<a href='https://oodt.jpl.nasa.gov/jira/browse/PDS-440'>PDS-440</a>] - Tool Registry: Develop a script to migrate the Search Tools list to products
          </li>
          <li>[<a href='https://oodt.jpl.nasa.gov/jira/browse/PDS-456'>PDS-456</a>] - PDS4-Tools: Add initial support for table Arrays to csv transformations
          </li>
          <li>[<a href='https://oodt.jpl.nasa.gov/jira/browse/PDS-465'>PDS-465</a>] - Registry: Update Registry Client to include support for the Package object
          </li>
        </ul>
      </subsection>

      <subsection name="Modified Capabilities">
        <p>The following capabilities have been modified for this release:
        </p>

        <ul>
          <li>[<a href='https://oodt.jpl.nasa.gov/jira/browse/PDS-442'>PDS-442</a>] - PDS4 Tools: Clean up the Maven hierarchy and documentation
          </li>
          <li>[<a href='https://oodt.jpl.nasa.gov/jira/browse/PDS-446'>PDS-446</a>] - Transform: Throws a could not find medialib accelerator wrapper classes message
          </li>
          <li>[<a href='https://oodt.jpl.nasa.gov/jira/browse/PDS-447'>PDS-447</a>] - Transport: Can&#39;t get transport-registry/prod?identifier-list to work
          </li>
          <li>[<a href='https://oodt.jpl.nasa.gov/jira/browse/PDS-449'>PDS-449</a>] - Transform: Support multiple image object types in a single label
          </li>
          <li>[<a href='https://oodt.jpl.nasa.gov/jira/browse/PDS-451'>PDS-451</a>] - Search: Handle Document products in the Product Search UI
          </li>
          <li>[<a href='https://oodt.jpl.nasa.gov/jira/browse/PDS-452'>PDS-452</a>] - PDS4-Tools: Support the new way display direction values are set in a label
          </li>
          <li>[<a href='https://oodt.jpl.nasa.gov/jira/browse/PDS-454'>PDS-454</a>] - Transform: Update velocity template to conform to the latest data model
          </li>
          <li>[<a href='https://oodt.jpl.nasa.gov/jira/browse/PDS-457'>PDS-457</a>] - Registry: Update Registry Client to include additional association query methods
          </li>
          <li>[<a href='https://oodt.jpl.nasa.gov/jira/browse/PDS-460'>PDS-460</a>] - Transform: documentation updates
          </li>
          <li>[<a href='https://oodt.jpl.nasa.gov/jira/browse/PDS-462'>PDS-462</a>] - Tracking: Resurrect the Security Service
          </li>
          <li>[<a href='https://oodt.jpl.nasa.gov/jira/browse/PDS-463'>PDS-463</a>] - Transform/Transport-OFSN: Remove image transformation types that are not commonly used
          </li>
          <li>[<a href='https://oodt.jpl.nasa.gov/jira/browse/PDS-464'>PDS-464</a>] - Update Windows System Properties Install Guide
          </li>
        </ul>
      </subsection>

      <subsection name="Corrected Capabilities">
        <p>The following capabilities have been corrected for this release:
        </p>

        <ul>
          <li>[<a href='https://oodt.jpl.nasa.gov/jira/browse/PDS-441'>PDS-441</a>] - Report: IT Security reports an Cross-Site Scripting issue with Sawmill
          </li>
          <li>[<a href='https://oodt.jpl.nasa.gov/jira/browse/PDS-448'>PDS-448</a>] - Transform: Does not display list of supported objects correctly
          </li>
          <li>[<a href='https://oodt.jpl.nasa.gov/jira/browse/PDS-455'>PDS-455</a>] - PDS4-Tools: Creates a Generic Object with incorrect file size and offset
          </li>
        </ul>
      </subsection>
    </section>

    <section name="Liens">
      <p>This section details the liens against the capabilities that have yet to be implemented or are partially implemented. They are summarized here for a system-level view. A more detailed list of liens can be found in the release notes for each component.
      </p>

      <ul>
        <li>Upgrade miscellaneous portal interfaces to remove the dependence on the PDS3 catalog database.
        </li>
      </ul>
    </section>

    <section name="System Requirements">
      <p>This section details the system requirements for installing and operating the software. Specific system requirements for each component in this release can be found in their respective Installation documents.
      </p>

      <subsection name="Java Runtime Environment">
        <p>The custom software contained in this release was developed using Java and will run on any platform with a supported Java Runtime Environment (JRE). The software was specifically compiled for Java version 1.7 and has been tested with this version and version 1.8. The following commands test the local Java installation in a UNIX-based environment:
        </p>

        <source>
% which java
/usr/bin/java

% java -version
java version "1.7.0_72"
Java(TM) SE Runtime Environment (build 1.7.0_72-b14)
Java HotSpot(TM) 64-Bit Server VM (build 24.72-b04, mixed mode)
        </source>

        <p>The first command above checks whether the <i>java</i> executable is in the environment's path and the second command reports the version. If Java is not installed or the version is not at least 1.7, Java will need to be downloaded and installed in the current environment. Consult the local system administrator for installation of this software. For the do-it-yourself crowd, the Java software can be downloaded from the <a href="http://www.oracle.com/technetwork/java/javase/downloads/" target="_blank">Oracle Java Download</a> page. The suggested software package is the Java Standard Edition (SE) 7, either the JDK or the JRE package. The JDK package is not necessary to run the software but could be useful if development and compilation of Java software will also occur in the current environment.
        </p>
      </subsection>

      <subsection name="Java Application Server">
        <p>The other main system requirement pertains to providing a Java application server for hosting certain components (e.g., Registry Service, Search Service, etc.). The suggested application server for this release is Apache Tomcat with a minimal version of <i>7.0.X</i>. Version <i>8.0.X</i> is also supported in this release and is required if you are running Java version 1.8 in your environment. Consult the local system administrator for installation of this software. For the do-it-yourself crowd, see the <a href="index-tomcat.html">Tomcat Deployment</a> document for installation and configuration details.
        </p>
      </subsection>

      <subsection name="Web Server">
        <p>The installation of a web server to act as a front-end interface to the Java application server is desired. The suggested web server for this release is the Apache HTTP Server. Consult the local system administrator for installation of this software. For the do-it-yourself crowd, the Apache HTTP Server software can be downloaded from the <a href="http://httpd.apache.org/" target="_blank">Apache HTTP Server</a> page.
        </p>
      </subsection>

      <subsection name="Database Server">
        <p>The installation of a database server is suggested to support the deployment of the Registry Service. The Registry Service comes prepackaged with the Apache Derby database but isn't necessarily the preferred choice for an operational deployment. Other options supported by the Registry Service include MySQL and PostgreSQL. Consult the local system administrator for installation of these database servers. For the do-it-yourself crowd, the MySQL software can be downloaded from the <a href="https://www.mysql.com/" target="_blank">MySQL</a> page while the PostgreSQL software can be downloaded from the <a href="http://www.postgresql.org/" target="_blank">PostgresSQL</a> page.
        </p>

        <p>If another database server is preferred, contact the EN so we can help prepare a database-specific configuration for your environment.
        </p>
      </subsection>
    </section>

    <section name="Installation/Operation">
      <p>This section details the installation and operation of the software in this release. This release is intended for deployment in the Engineering Node operations environment with certain components deployed in the environments of participating Nodes. Details regarding the release for each of these components, including installation of the packages and operation of the associated software, can be found in the documentation for each component. This release is comprised of the following components:
      </p>

      <ul>
        <li><a href="../ingest/index.html">Ingest</a></li>
        <ul>
          <li><a href="../ingest/catalog/index.html">Catalog Tool</a> - 1.11.0 (EN Only)</li>
          <li><a href="../ingest/harvest/index.html">Harvest Tool</a> - 1.11.0</li>
          <li><a href="../ingest/harvest-pdap/index.html">Harvest-PDAP Tool</a> - 1.5.0 (EN Only)</li>
        </ul>
        <li><a href="../portal/index.html">Portal</a></li>
        <ul>
          <li><a href="../portal/dd-search/index.html">Data Dictionary Search</a> - 1.3.0 (EN Only)</li>
          <li><a href="../portal/ds-view/index.html">Data Set View</a> - 2.8.0 (DN Optional)</li>
          <li><a href="../portal/filter/index.html">Filter</a> - 0.4.0 (DN Optional)</li>
          <li><a href="../portal/pb-search/index.html">Phone Book Search</a> - 1.3.0 (EN Only)</li>
          <li><a href="../portal/tool-registry/index.html">Tool Registry</a> - 1.0.0 (EN Only)</li>
        </ul>
        <li><a href="../preparation/index.html">Preparation Tools</a></li>
        <ul>
          <li><a href="../preparation/core/index.html">Core Library</a> - 1.9.1</li>
          <li><a href="../preparation/generate/index.html">Generate Tool</a> - 0.11.0</li>
          <li><a href="../preparation/pds4-tools/index.html">PDS4 Tools</a> - 0.7.0</li>
          <li><a href="../preparation/transform/index.html">Transform Tool</a> - 1.4.0</li>
          <li><a href="../preparation/validate/index.html">Validate Tool</a> - 1.9.1</li>
        </ul>
        <li><a href="../registry/index.html">Registry</a></li>
        <ul>
          <li><a href="../registry/registry-core/index.html">Registry Core</a> - 1.11.0</li>
          <li><a href="../registry/registry-client/index.html">Registry Client</a> - 1.11.0</li>
          <li><a href="../registry/registry-service/index.html">Registry Service</a> - 1.11.0</li>
          <li><a href="../registry/registry-tools/index.html">Registry Tools</a> - 1.11.0</li>
          <li><a href="../registry/registry-ui/index.html">Registry User Interface</a> - 1.11.0</li>
        </ul>
        <li><a href="../report/index.html">Report</a></li>
        <ul>
          <li><a href="../report/report-manager/index.html">Report Manager</a> - 1.10.0 (EN Only)</li>
          <li><a href="../report/sawmill/index.html">Sawmill</a> - 1.10.0 (EN Only)</li>
        </ul>
        <li><a href="../search/index.html">Search</a></li>
        <ul>
          <li><a href="../search/search-analytics/index.html">Search Analytics</a> - 1.9.0</li>
          <li><a href="../search/search-core/index.html">Search Core</a> - 1.9.0</li>
          <li><a href="../search/search-service/index.html">Search Service</a> - 1.9.0</li>
          <li><a href="../search/search-ui/index.html">Search User Interface</a> - 1.9.0 (EN Only)</li>
          <li><a href="../search/product-search-ui/index.html">Product Search User Interface</a> - 1.9.0 (DN Optional)</li>
        </ul>
        <li><a href="../security/index.html">Security Service</a> - 1.4.0 (EN Only)</li>
        <li><a href="../storage/index.html">Storage</a></li>
        <ul>
          <li><a href="../storage/storage-service/index.html">Storage Service</a> - 1.2.0 (EN Only)</li>
          <li><a href="../storage/product-service/index.html">Product Service</a> - 1.2.0 (EN Only)</li>
        </ul>
        <li><a href="../transport/index.html">Transport</a></li>
        <ul>
          <li><a href="../transport/transport-proxy/index.html">Transport Proxy</a> - 1.4.0 (EN Only)</li>
          <li><a href="../transport/transport-ofsn/index.html">Transport Service (OFSN)</a> - 1.5.0</li>
          <li><a href="../transport/transport-registry/index.html">Transport Service (Registry)</a> - 1.3.0</li>
          <li><a href="../transport/transport-upload/index.html">Transport Service (Upload)</a> - 0.2.0</li>
        </ul>
      </ul>

      <p>Not all of the above components are required for a given installation of the software for this release. The following sections detail typical deployment scenarios for the Engineering Node and the Discipline Nodes, respectively.
      </p>

      <subsection name="Engineering Node Environment">
        <p>This section provides an overview of the deployment to the Engineering Node operations environment. The following diagram depicts the EN system flow, starting with central catalog migration, data product registration and finishing up with search index generation:
        </p>

        <center>
          <a href="../images/en-system-flow-2.2.0.jpg" target="_blank"><img alt="EN System Flow" src="../images/en-system-flow-2.2.0-scale.jpg" border="1" /></a><br/>
          Click the image for a larger version.
        </center>

        <p>The components depicted above serve as the operational deployment of this release for the Engineering Node. The main purpose of this deployment is to support catalog-level search for the PDS.
        </p>

        <ul>
          <li><b>Catalog Tool</b><br/>
            <p>The Catalog Tool provides the means for registering PDS3 catalog files with the Registry Service. This tool provides functionality for comparing, validating and ingesting a catalog submission.
            </p>
          </li>
          <li><b>Harvest Tool</b><br/>
            <p>The Harvest Tool provides the means for registering products with the Registry Service. This tool reads a PDS4 product label, extracts specified metadata and registers the product with the registry. This tool allows the user to register a batch of products and generates a summary report.
            </p>
          </li>
          <li><b>Registry Service</b><br/>
            <p>The Registry Service provides functionality for tracking, auditing, locating and maintaining artifacts within the system. Two instances of the service have been deployed, one containing context products migrated from the PDS3 central catalog database and one containing the initial set of PDS4 context products. The end points for these services are:
              <ul>
                <li><a href="https://pds.nasa.gov/services/registry-pds3/" target="_blank">https://pds.nasa.gov/services/registry-pds3/</a></li>
                <li><a href="https://pds.nasa.gov/services/registry-pds4/" target="_blank">https://pds.nasa.gov/services/registry-pds4/</a></li>
              </ul>
              <br/>
            </p>
          </li>
          <li><b>Search Service</b><br/>
            <p>The Search Service provides functionality for accepting queries from data consumers for registered products and includes functionality for retrieving search results. This component acts as the interface to the Registry Service for the data consumer. The end point for this service is <a href="https://pds.nasa.gov/services/search/" target="_blank">https://pds.nasa.gov/services/search/</a>.
            </p>
          </li>
          <li><b>Search User Interface</b><br />
            <p>The Search User Interface software serves as the user interface for the Search Service on the PDS website. The end point for this application is <a href="https://pds.nasa.gov/tools/data-search/" target="_blank">https://pds.nasa.gov/tools/data-search/</a>.
            </p>
          </li>
          <li><b>Report Service</b><br/>
            <p>The Report Service provides the capability for capturing and reporting metrics. With this release, the service supports generation of monthly metrics for each of the Nodes.
            </p>
          </li>
        </ul>
      </subsection>

      <subsection name="Discipline Node Environment">
        <p>This section details the deployment to a Discipline Node environment. The Nodes are asked to download, install and exercise the software that makes up this release. The following diagram details an example deployment of selected components:
        </p>

        <center>
          <a href="../images/dn-deploy-4.0.0.jpg" target="_blank"><img alt="DN Deployment" src="../images/dn-deploy-4.0.0-scale.jpg" border="1" /></a><br/>
          Click the image for a larger version.
        </center>

        <p>The components depicted above represent a typical deployment of the PDS4 software on a single server.  The following diagram depicts a normalized system flow, starting with schema design, continuing onto data product label generation and validation and finishing up with data product registration and search index generation:
        </p>

        <center>
          <a href="../images/dn-system-flow-7.0.0.jpg" target="_blank"><img alt="DN System Flow" src="../images/dn-system-flow-7.0.0-scale.jpg" border="1" /></a><br/>
          Click the image for a larger version.
        </center>

        <p>This diagram identifies where the system components come into play within the system flow. These components and the ones depicted in the deployment diagram, are described in more detail with respect to how the components can be utilized in operations:
        </p>

        <ul>
          <li><b>Design Tool</b><br/>
            <p>The Design Tool is intended to aid users in the development of their data product label schemas. This release identifies two off-the-shelf products (Oxygen and Eclipse) that are available for this purpose. The provided documentation guides the user with respect to the download, installation and operation of each of these products.
            </p>
          </li>
          <li><b>Generate Tool</b><br/>
            <p>The Generate Tool is intended to aid users in the generation of their data product labels. This tool was developed by the Imaging Node at JPL and provides a command-line interface for generating PDS4 Labels from either a PDS3 Label or a PDS-specific DOM object.
            </p>
          </li>
          <li><b>Validate Tool</b><br/>
            <p>The Validate Tool comes pre-packaged with the latest version of the core XML Schema and Schematron files generated from the data model. The tool allows the user to validate collections of products or single products against the associated core schema. Discipline and mission schemas can be passed into the tool to enable a more detailed validation check. Although the Design Tools listed above provide a file-by-file validation capability, this tool allows the user to validate a batch of products and generates a summary report.
            </p>
          </li>
          <li><b>Transform Tool / PDS4 Tools</b><br/>
            <p>The Transform Tool and the PDS4 Tools library provide product transformation capability. The Transform Tool provides a command-line interface to a subset of the functions offered by the PDS4 Tools library. In addition, the PDS4 Tools library provides functionality for accessing PDS4 data objects. The functionality of both of these components will be expanded in future releases.
            </p>
          </li>
          <li><b>Harvest Tool</b><br/>
            <p>The Harvest Tool provides the means for registering products with the Registry Service. This tool reads a PDS4 product label, extracts specified metadata and registers the product with the registry. This tool allows the user to register a batch of products and generates a summary report. This tool also supports registration of PDS3 data sets for the purpose of tracking and reporting.
            </p>
          </li>
          <li><b>Registry</b></li><br/>
          <ul>
            <li><b>Registry Service</b><br/>
              <p>The Registry Service provides functionality for tracking, auditing, locating and maintaining artifacts within the system. Ultimately, all products (including PDS3 products) will be registered and tracked with the Registry Service.
              </p>
            </li>
            <li><b>Registry User Interface</b><br/>
              <p>The Registry User Interface provides a simple viewing capability of the contents of the associated Registry Service. It is intended to offer visual verification of successful registration of products as well as the ability to update the status for registered products.
              </p>
            </li>
          </ul>
          <li><b>Search</b></li><br/>
          <ul>
            <li><b>Search Core</b><br/>
              <p>The Search Core component provides functionality for generating the search index utilized by the Search Service for retrieving search results.
              </p>
            </li>
            <li><b>Search Service</b><br/>
              <p>The Search Service provides functionality for accepting queries from data consumers for registered products and includes functionality for retrieving search results. This component acts as the interface to the Registry Service for the data consumer.
              </p>
            </li>
            <li><b>Product Search User Interface</b><br/>
              <p>The Product Search User Interface software serves as the user interface for the Search Service for querying and displaying search results.
              </p>
            </li>
          </ul>
          <li><b>Transport</b></li><br/>
          <ul>
            <li><b>Transport Service (OFSN)</b><br/>
              <p>The Online File Specification Name (OFSN) Transport Service provides functionality for transporting and transforming PDS products. This service offers a similar interface to the PDS-D Product Server and allows a user to interface with an archive directory structure for discovering and retrieving product files.
              </p>
            </li>
            <li><b>Transport Service (Registry)</b><br/>
              <p>The Registry Transport Service provides functionality for transporting and transforming PDS products. This service interfaces with the Registry Service or Search Service to discover and retrieve products files given a logical identifier.
              </p>
            </li>
          </ul>
        </ul>

        <p><b><i>Installation Procedures for Core Components</i></b></p>

        <p>Although the Design, Generate and Transform Tools are included with this release, we have not included them in the installation procedure because they may not pertain to every Discipline Node. This procedure will focus on installing the Registry components, Harvest Tool and Validate Tool. The example commands below assume the software is installed in the user's home directory, indicated by the <i>$HOME</i> environment variable. If this is not the case or if this variable is not defined, the absolute path should be used instead of the variable. Some of the commands below have been broken into multiple lines for readability. The commands should be reassembled into a single line prior to execution. Perform the following steps to download, install, configure and test the software in the Node's local environment:
        </p>

        <ol>
          <li><b>Verify System Requirements</b><br/>
            <p>As specified in the <a href="#System_Requirements">System Requirements</a> section above, the software requires Java, a Java Application Server (Apache Tomcat), a Web Server (Apache HTTP) and an optional database server to be installed and accessible. These installations should be verified before proceeding to the next step.
            </p>
            <p>With respect to the Web Server installation, this server may reside on another server and in most cases that would be preferable. The preferred configuration is to install the PDS4 software components on a server that resides behind a firewall at your institution. This offers an initial level of security for the components. Configuring the Web Server for reverse proxies to the query interfaces of the components provides an additional level of security by restricting access to the interfaces that allow updates to the data.
            </p>
          </li>
          <li><b>Install Registry Components</b><br/>
            <p>The Registry components consist of the Registry Service and Registry User Interface. The Registry Client and Registry Core, which are also Registry components, are not required to be installed at the Discipline Node.
            </p>
          </li>
          <ul>
            <li><b>Registry Service</b><br/>
              <p>The <a href="../registry/registry-service/install/index.html">Installation</a> document for the Registry Service provides the details for downloading, installing and configuring the software. The Secure Configuration is skipped for the DN deployment. The reverse proxy configuration that follows provides security for the Registry Service instances. The PDS3 and PDS4 instances of the service are accessed at <i>/services/registry-pds3</i> and <i>/services/registry-pds4</i>, respectively, on the web server which is facilitated by the following reverse proxy configuration in the Apache HTTP Server <i>httpd.conf</i> file:
              </p>
              <source>
ProxyPass /services/registry-pds3/ http://localhost:8080/registry-pds3/
ProxyPassReverse /services/registry-pds3/ http://localhost:8080/registry-pds3/
ProxyPass /services/registry-pds3 http://localhost:8080/registry-pds3
ProxyPassReverse /services/registry-pds3 http://localhost:8080/registry-pds3
&lt;Location /services/registry-pds3&gt;
  &lt;Limit PUT POST DELETE&gt;
    Order Deny,Allow
    Deny from All
    Allow from 127.0.0.1
  &lt;/Limit&gt;
&lt;/Location&gt;

ProxyPass /services/registry-pds4/ http://localhost:8080/registry-pds4/
ProxyPassReverse /services/registry-pds4/ http://localhost:8080/registry-pds4/
ProxyPass /services/registry-pds4 http://localhost:8080/registry-pds4
ProxyPassReverse /services/registry-pds4 http://localhost:8080/registry-pds4
&lt;Location /services/registry-pds4&gt;
  &lt;Limit PUT POST DELETE&gt;
    Order Deny,Allow
    Deny from All
    Allow from 127.0.0.1
  &lt;/Limit&gt;
&lt;/Location&gt;
              </source>
              <p>The above configuration will likely need to be performed by the System Administrator. This configuration assumes the Apache HTTP Server is on the same server as the Apache Tomcat Server. If that is not the case, the <i>localhost</i> designation above should be replaced with the DNS name of the server where the Apache Tomcat Server is installed. This configuration allows GET requests through the public interface but restricts PUT, POST and DELETE requests to processes running on the local server.
              </p>
            </li>
            <li><b>Registry User Interface</b><br/>
              <p>The <a href="../registry/registry-ui/install/index.html">Installation</a> document for the Registry User Interface provides the details for downloading, installing and configuring the software. The Secure Configuration may be skipped for the DN deployment.
              </p>
            </li>
          </ul>
          <li><b>Install Harvest Tool</b><br/>
            <p>The <a href="../ingest/harvest/install/index.html">Installation</a> document for the Harvest Tool provides the details for downloading and installing the software. In order to support multiple instances of the Registry Service, it is suggested to do the following:
            </p>
            <ul>
              <li>Make a copy of the <i>harvest</i> script provided with the software for each Registry Service instance:<br/>
              <source>
% cd $HOME/harvest-1.11.0/bin
% cp harvest harvest-pds3
% cp harvest harvest-pds4
              </source>
              </li>
              <li>Edit the newly created <i>harvest-pds3</i> script and change the <i>http://localhost:8080/registry</i> specification to <i>http://localhost:8080/registry-pds3</i>.
              </li>
              <li>Edit the newly created <i>harvest-pds4</i> script and change the <i>http://localhost:8080/registry</i> specification to <i>http://localhost:8080/registry-pds4</i>.
              </li>
            </ul>
          </li>
          <li><b>Install Validate Tool</b><br/>
            <p>The <a href="../preparation/validate/install/index.html">Installation</a> document for the Validate Tool provides the details for downloading and installing the software.
            </p>
          </li>
        </ol>

        <p><b><i>Installation Verification for Core Components</i></b></p>

        <p>Now that the core software is installed, it can be exercised with a local bundle prepared by the Node or with the Example Bundle available from the EN. The following steps detail exercising of the software with the Example Bundle:
        </p>

        <ol>
          <li><b>Download Example Bundle</b><br/>
            <p>The bundle can be downloaded from the <a href="https://starbase.jpl.nasa.gov/pds4/1700/dph_example_archive_VG2PLS.zip">PDS4 Repository</a>. Unzipping the package results in a directory named <i>dph_example_archive_VG2PLS</i>.
            </p>
          </li>
          <li><b>Validate Example Bundle</b><br/>
            <p>The next step exercises the Validate Tool by validating the Example Bundle. The <a href="../preparation/validate/operate/index.html">Operation</a> document for the Validate Tool provides the details for executing the software. Execute the Validate Tool against the Example Bundle with the following commands:
            </p>
            <source>
% cd $HOME/validate-1.9.1/bin
% ./validate -t $HOME/dph_example_archive_VG2PLS \
  -x $HOME/dph_example_archive_VG2PLS/xml_schema/PDS4_PDS_1700.xsd \
     $HOME/dph_example_archive_VG2PLS/xml_schema/PDS4_DPH_1700.xsd \
  -S $HOME/dph_example_archive_VG2PLS/xml_schema/PDS4_PDS_1700.sch
            </source>
            <p>The above run results in a successful validation:
            </p>

            <source>
...
Summary:

  18 of 18 file(s) processed, 0 skipped
  18 of 18 file(s) passed validation

End of Report
            </source>

            <p>Note that the core schema (PDS4_PDS_1700.xsd) was also passed on the command-line because passing any schema on the command-line overrides the schemas provided with the tool. Also note that the <i>-e "*.xml"</i> was not included in the command above. The tool now defaults using <i>*.xml</i> and <i>*.XML</i> as the regular expression for file selection.
            </p>
          </li>
          <li><b>Register Example Bundle</b><br/>
            <p>The next step exercises the Harvest Tool and Registry Service by registering the contents of the Example Bundle. The <a href="../ingest/harvest/operate/index.html">Operation</a> document for the Harvest Tool provides the details for executing the software. A configuration file (<i>harvest-policy-example.xml</i>) for registering the Example Bundle can be found in the <i>examples</i> directory of the Harvest Tool distribution package. Depending on the location of the Example Bundle in the local environment, the file and path specifications in the configuration file will likely need to be updated for the Example Bundle location in the local environment. Execute the Harvest Tool against the Example Bundle with the following commands:
            </p>
            <source>
% cd $HOME/harvest-1.11.0/bin
% ./harvest-pds4 -c ../examples/harvest-policy-example.xml
            </source>
            <p>The above run will result in no errors and a few warnings pertaining to references for products that were not found in the local registry. The rest of the products should get registered successfully. The summary should look something like the following:
            </p>
            <source>
...
Summary:

13 of 13 file(s) processed, 5 other file(s) skipped
0 error(s), 2 warning(s)

13 of 13 products registered.
81 of 81 ancillary products registered.

Product Types Registered:
5 Product_Collection
2 Product_Document
1 Product_Observational
1 Product_Browse
3 Product_File_Text
81 Product_File_Repository
1 Product_Bundle

79 of 79 generated checksums matched their supplied value in 
the manifest, 2 value(s) not checked.

67 of 67 generated checksums matched the supplied value in 
their product label, 14 value(s) not checked.

81 of 81 associations registered.

End of Log
            </source>
          </li>
          <li><b>View Registry Contents</b><br/>
            <p>The next step verifies that the registered content from the previous step can be viewed via the Registry Service REST-based API and the Registry User Interface. The <a href="../registry/registry-service/operate/index.html">Operation</a> document for the Registry Service provides the details for interfacing with the service via the REST-based API. Assuming the registration above was performed against the PDS4 instance of the service, the Registry Service should be accessible via the following URL: <i>http://localhost:8080/registry-pds4/</i>. Accessing the <i>report</i> end point (append report to the URL) from the desired web browser (some browsers display XML better than others), should produce the following output:
            </p>
            <source>
&lt;ns2:report xmlns:ns2="http://registry.pds.nasa.gov" status="OK"
serverStarted="2016-10-01T11:15:31.291-07:00" associations="337"
extrinsics="94" services="0" classificationSchemes="2"
classificationNodes="69" packages="5" events="170"
registryVersion="1.11.0"/&gt;
            </source>
            <p>The above report shows 94 extrinsics (PDS products) registered which corresponds with the Harvest Tool summary. The number of associations registered is a little harder to verify because there were already some associations in the registry from the configuration step. Feel free to try out some of the other end points (e.g. extrinsics) detailed in the <a href="../registry/registry-service/operate/index.html#Query_Artifacts">Query Artifacts</a> section of the Operations document.
            </p>
            <p>Assuming the registration above was performed against the PDS4 instance of the service, the Registry User Interface should be accessible via the following end point: <i>http://localhost:8080/registry-ui/</i>. Select the PDS4 Registry Service instance (http://localhost:8080/registry-pds4/) from the Registry Service pull-down menu and review the resulting product listing. If an "RPC Failure" message appears near the bottom of the screen, this is most likely the result of the Registry Service end point not being configured correctly. The <a href="../registry/registry-ui/install/index.html">Installation</a> document for the Registry User Interface specifies how to modify the appropriate configuration file to correct this situation.
            </p>
          </li>
          <li><b>Approve Registry Contents</b><br/>
            <p>When content is ingested with the Registry Service, it is given an initial status of <i>Submitted</i>. In order for the Search Core component to index this content, it must be given a status of <i>Approved</i>. Using the Registry User Interface, perform the following steps to approve the Example Bundle:
            </p>
            <ol>
              <li>Select the <i>Packages</i> tab</li>
              <li>Identify the package associated with the Example Bundle</li>
              <li>Select the check box next to that package</li>
              <li>Select the <i>Approved</i> value from the <i>Status</i> pulldown menu</li>
              <li>Select the <i>Update Status</i> button</li>
            </ol>
            <p>
            </p>
          </li>
        </ol>

        <p>The above steps exercise the core components of the system but are not exhaustive by any measure with respect to testing the software, but they will verify that the software can be installed and executed in the various Node environments. Some Nodes are actively working on generating PDS4 bundles and collections. If a Node would like to attempt to register those products with their local registry the EN would be glad to assist in this effort. In addition, the Harvest Tool supports registering a PDS3 Data Set with the Registry Service. An example configuration file (<i>harvest-policy-pds3.xml</i>) for registering PDS3 Data Sets can be found in the <i>examples</i> directory of the Harvest Tool distribution package. When registering a PDS3 Data Set, the Harvest Tool creates an in-memory proxy label for each product and registers it with the Registry Service. Although not sufficient for PDS4 migration, it does provide a tracking mechanism for PDS3 Data Sets until they can be migrated to PDS4.
        </p>

        <p><b><i>Installation Procedures for Search Components</i></b></p>

        <p>Not all Discipline Nodes will need to install the Search Components and depending on the situation, they may only need to install the Search Service and Search Core components. The installation approach will be determined on a Node-by-Node basis. That said, the following procedure details the installation of all four components. The Search components consist of the Search Service, Search Core and Product Search User Interface. The Search User Interface, which is a Search component, is not required to be installed at the Discipline Node.
        </p>

        <ol>
          <li><b>Search Service</b><br/>
            <p>The <a href="../search/search-service/install/index.html">Installation</a> document for the Search Service provides the details for downloading, installing and configuring the software. The reverse proxy configuration that follows provides security for the Search Service instance. The instance of the service is accessed at <i>/services/search</i> on the web server which is facilitated by the following reverse proxy configuration in the Apache HTTP Server <i>httpd.conf</i> file:
            </p>
            <source>
ProxyPass /services/search/ http://localhost:8080/search-service/
ProxyPassReverse /services/search/ http://localhost:8080/search-service/
ProxyPass /services/search http://localhost:8080/search-service
ProxyPassReverse /services/search http://localhost:8080/search-service

&lt;Location /services/search/admin&gt;
Order Deny,Allow
Deny from all
Allow from 137.78.0.0/255.255.0.0 137.79.0.0/255.255.0.0 .jpl.nasa.gov
&lt;/Location&gt;
            </source>
            <p>The last portion of the configuration above limits access to the Apache Solr Admin interface to folks outside of the institution. The values in the <i>Allow from...</i> line need to be modified for your local network.
            </p>
          </li>
          <li><b>Search Core</b><br/>
            <p>The <a href="../search/search-core/install/index.html">Installation</a> document for the Search Core software provides the details for downloading, installing and configuring the software.
            </p>
          </li>
          <li><b>Product Search User Interface</b><br/>
            <p>The <a href="../search/product-search-ui/install/index.html">Installation</a> document for the Product Search User Interface provides the details for downloading, installing and configuring the software. The application can be accessed at <i>/search</i> (the actual end point is up to the user) on the web server which is facilitated by the following reverse proxy configuration in the Apache HTTP Server <i>httpd.conf</i> file:
            </p>
            <source>
ProxyPass /search/ http://localhost:8080/product-search-ui/
ProxyPassReverse /search/ http://localhost:8080/product-search-ui/
ProxyPass /search http://localhost:8080/product-search-ui
ProxyPassReverse /search http://localhost:8080/product-search-ui
            </source>
            <p>The above reverse proxy configuration is optional since there may be a situation where the Node does not want to expose this interface to external users.
            </p>
          </li>
          <li><b>Data Set View</b><br/>
            <p>The <a href="../portal/ds-view/install/index.html">Installation</a> document for the Data Set View software provides the details for downloading, installing and configuring the software. When following the instructions in the <a href="../portal/ds-view/install/index.html#Configuring_the_Application">Configuring the Application</a> section of the Installation document, the values for the <i>registry.url</i> and <i>proxy.registry.url</i> parameters can be ignored (leave them at their defaults). The application is accessed at <i>/ds-view</i> on the web server which is facilitated by the following reverse proxy configuration in the Apache HTTP Server <i>httpd.conf</i> file:
            </p>
            <source>
ProxyPass /ds-view/ http://localhost:8080/ds-view/
ProxyPassReverse /ds-view/ http://localhost:8080/ds-view/
ProxyPass /ds-view http://localhost:8080/ds-view
ProxyPassReverse /ds-view http://localhost:8080/ds-view
            </source>
            <p>The above configuration is only required if the Product Search User Interface is also accessed via a reverse proxy on the web server.
            </p>
          </li>
        </ol>

        <p><b><i>Installation Verification for Search Components</i></b></p>

        <p>Now that the Search Components are installed, they can be exercised by generating and deploying the search index to the Search Service with the Search Core component. The following command will extract the contents from the PDS4 instance of the Registry Service (populated with the Example Bundle), generate the index and post it to the Search Service:
        </p>

        <source>
% search-core -H /usr/local/search-service/pds \
  -p /usr/local/search-core/conf/defaults/pds/pds4/core.properties \
  -l index.log
        </source>

        <p>Assuming the above command completes successfully, the Search Service should now contain the products from the Example Bundle. This can be verified via the Search Service interface (<i>http://localhost:8080/search-service</i>). Accessing the service from the desired web browser (some browsers display XML better than others), should produce a default HTML-formatted output listing the products. Accessing the Product Search User Interface (<i>http://localhost:8080/product-search-ui</i>), should also display a list of the products. If products are not displayed, review the Search Core log file for errors. If it shows that zero products were indexed, make sure the Example Bundle products were set to a status of <i>Approved</i>.
        </p>

        <p><b><i>Exercise Wrap Up</i></b></p>

        <p>In addition to the exercises above, the Nodes are encouraged to exercise the Generate Tool, Transform Tool and PDS4 Tools components. See the corresponding Installation and Operation documents for details. For advanced installations, the Transport components may also be installed (details to come later).
        </p>

        <p>The final step of this exercise is to delete the Example Bundle from the Registry Service. This can be accomplished via the Registry User Interface at the following end point: <i>http://localhost:8080/registry-ui/</i>. In the <i>Packages</i> tab just select the entry for the Example package and then select the <i>Delete</i> button. This action may take a few seconds to complete. Now the Registry Service is ready for your Bundles.
        </p>

        <!--
        <ol>
          <li><b>Install Transport Components</b><br/>
            <p>The Transport components consist of the OFSN and Registry Transport Services. The Transport Proxy, which is a Transport component, is not required to be installed at the Discipline Node.
            </p>
          </li>
          <ul>
            <li><b>Transport Service (OFSN)</b><br/>
              <p>TBD
              </p>
            </li>
            <li><b>Transport Service (Registry)</b><br/>
              <p>TBD
              </p>
            </li>
          </ul>
        </ol>
        -->
      </subsection>
    </section>
  </body>
</document>
