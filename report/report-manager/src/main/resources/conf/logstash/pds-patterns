#
# Whenever you deploy a new version of Logstash, create a directory inside the deployment called
# "patterns" and copy this file inside it.
#

PARTIAL_EMAIL %{HTTPDUSER}|%{EMAILLOCALPART}@

HTTPD_ADAPTEDLOG %{IPORHOST:clientip} %{NOTSPACE:ident} %{PARTIAL_EMAIL:auth} \[%{HTTPDATE:timestamp}\] "(?:%{WORD:verb} %{NOTSPACE:request}(?: HTTP/%{NUMBER:httpversion})?|%{DATA:rawrequest})" %{NUMBER:response} (?:%{NUMBER:bytes}|-) %{QS:referrer} %{QS:agent}
HTTPD_MISSINGAUTH %{IPORHOST:clientip} %{HTTPDUSER:ident} \[%{HTTPDATE:timestamp}\] "(?:%{WORD:verb} %{NOTSPACE:request}(?: HTTP/%{NUMBER:httpversion})?|%{DATA:rawrequest})" %{NUMBER:response} (?:%{NUMBER:bytes}|-) %{QS:referrer} %{QS:agent}

GENERIC_SPIDER .*spider.*
GENERIC_CRAWLER .*crawl.*
GOOGLEBOT .*googlebot.*
GOOGLE_CONTENT .*googleusercontent.*
MSNBOT .*msnbot.*
APPLEBOT .*applebot.*
YSE .*yse\.yahoo\.net.*
BINGBOT .*bingbot.*
BAIDU .*baiduspider.*

BOTS %{GENERIC_SPIDER}|%{GENERIC_CRAWLER}|%{GOOGLEBOT}|%{GOOGLE_CONTENT}|%{MSNBOT}|%{APPLEBOT}|%{YSE}|%{BINGBOT}|%{BAIDU}