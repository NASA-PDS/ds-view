<?xml version="1.0" encoding="UTF-8"?>

<!--
  Copyright 2010, by the California Institute of Technology.
  ALL RIGHTS RESERVED. United States Government Sponsorship acknowledged.
  Any commercial use must be negotiated with the Office of Technology Transfer
  at the California Institute of Technology.

  This software is subject to U. S. export control laws and regulations
  (22 C.F.R. 120-130 and 15 C.F.R. 730-774). To the extent that the software
  is subject to U.S. export control laws and regulations, the recipient has
  the responsibility to obtain export licenses or other export authority as
  may be required before exporting such information to foreign countries or
  providing access to foreign nationals.

  $Id$
-->

<document>
  <properties>
    <title>Installation</title>
    <author email="Jordan.Padams@jpl.nasa.gov">Jordan Padams</author>
    <author email="Sean.Hardman@jpl.nasa.gov">Sean Hardman</author>
  </properties>

  <body>
    <section name="Installation">
      <p>This section describes how to install the <a href="http://www.sawmill.net/" target="_blank">Sawmill</a> software package. This package serves as the majority of the Report Service for the PDS 2010 system. The following topics can be found in this section:
      </p>

      <ul>
        <li><a href="#System_Requirements">System Requirements</a></li>
        <li><a href="#Software_Installation">Software Installation</a></li>
      </ul>
    </section>

    <section name="System Requirements">
      <p>The software that makes up this project consists of a commercial package that is available for download and installation. The current version of the Sawmill package is 8.1.7. If installing the package in <a href="#Web_Server_Mode_Installation">Web Server Mode</a>, there are no further system requirements. If installing the package in <a href="#CGI_Mode_Installation">CGI Mode</a>, the following software is required to be installed on the host machine:
      </p>

      <ul>
        <li>Sun Java Standard Edition (J2SE) 1.6.X</li>
        <li>Apache Tomcat 6.0.20</li>
      </ul>
    </section>

    <section name="Software Installation">
      <p>This section details the download and installation of the Sawmill software package. At this time, the <a href="#CGI_Mode_Installation">CGI Mode</a> installation is preferred but if we procure a dedicated machine for this service in the future the <a href="#Web_Server_Mode_Installation">Web Server Mode</a> installation will be the best approach.
      </p>

      <subsection name="Download Software">
        <p>This section details how to download the software package from the Sawmill web site.
        </p>

        <ol>
          <li>Go to <a href="http://www.sawmill.net/downloads.html">http://www.sawmill.net/downloads.html</a>.</li>
          <li>Select the <i>Proceed</i> button (the form fields are optional).</li>
          <li>Select the desired version from the drop-down box, and select the <i>Proceed</i> button (“production (x.x.x)” preferred).</li>
          <li>Select the appropriate operating system for the host machine, and select the <i>Proceed</i> button.</li>
          <li>Select the appropriate hardware for the host machine, and select the <i>Proceed</i> button.</li>
          <li>The download will begin automatically.</li>
          <li>Verify that the <i>Operating System</i> and <i>Hardware Architecture</i> noted at the top of the page match that of the host machine.</li>
          <li>Once the download completes, copy the compressed Sawmill download file (.tar.gz) from the download location to the desired host machine.</li>
        </ol>
      </subsection>

      <subsection name="CGI Mode Installation">
        <p>This section details the CGI mode installation. In CGI mode, Sawmill runs as a CGI program under another web server. The instructions that follow specify this installation for an Apache Tomcat application server.
        </p>

        <ol>
          <li>Log onto the host machine with root privileges.</li>
          <li>Configure Apache Tomcat to support CGI binary executables.</li>
          <ul>
            <li>a. Remove XML comments surrounding the <i>CGIServlet</i> and CGI servlet-mapping configuration in $CATALINA_HOME/conf/web.xml.</li>
            <li>b. Add the following XML to the <i>CGIServletM</i> block in <i>$CATALINA_HOME/conf/web.xml</i> to support CGI as a binary executable:</li>
            <source>
&lt;init-param&gt;
  &lt;param-name&gt;executable&lt;/param-name&gt;
  &lt;param-value&gt;&lt;/param-value&gt;
&lt;/init-param&gt;
            </source>
            <li>c. Set attribute privileged=”true” for Context element in $CATALINA_HOME/conf/context.xml.</li>
            <li>d. Create a <i>cgi-bin</i> directory, if one does not already exist:</li>
            <source>
% mkdir $CATALINA_HOME/webapps/ROOT/WEB-INF/cgi-bin
            </source>
          </ul>
          <li>Navigate to the directory where the Sawmill compressed package was copied, and enter the following command from the command line:
            <source>
% gunzip -c (sawmill.tar.gz) | tar xf -
            </source>
            <p>A directory called <i>sawmill</i> is created containing the Sawmill executable file (sawmill) and a few other files.
            </p>
          </li>
          <li>Copy the executable and <i>LogAnalysisInfo</i> directory to the <i>cgi-bin</i> created in step 2d.</li>
          <source>
% cp (installation-directory)/sawmill (cgi-bin)/sawmill.cgi
% cp -r (installation-directory)/LogAnalysisInfo (cgi-bin)
          </source>
          <li>Open a web browser, and navigate to the URL <i>http://(yourserver)/cgi-bin/sawmill.cgi</i> .</li>
          <li>Enter <i>License Key</i> when prompted.</li>
          <li>Proceed through the steps to create an admin username and password.</li>
        </ol>
      </subsection>

      <subsection name="Web Server Mode Installation">
        <p>This section details the web server mode installation. In web server mode, Sawmill runs its own web server, and serves statistics using it.
        </p>

        <ol>
          <li>Log onto the host machine.</li>
          <li>Navigate to the directory where the Sawmill compressed package was copied, and enter the following command from the command line:
            <source>
% gunzip -c (sawmill.tar.gz) | tar xf -
            </source>
            <p>A directory called <i>sawmill</i> is created containing the Sawmill executable file (sawmill) and a few other files.
            </p>
          </li>
          <li>To run Sawmill, execute the following commands:
            <source>
cd sawmill
./sawmill &amp;
            </source>
            <p>Leave off <i>&amp;</i> if you prefer to not run Sawmill in the background.
            </p>
          </li>
          <li>Open a web browser, and navigate to the URL displayed when Sawmill was executed (will not be running on port 80).</li>
          <li>Enter <i>License Key</i> when prompted.</li>
          <li>Proceed through the steps to create an admin username and password.</li>
        </ol>
      </subsection>
    </section>
  </body>
</document>
